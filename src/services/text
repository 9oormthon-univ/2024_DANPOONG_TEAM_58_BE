실제 로직 및 에러처리